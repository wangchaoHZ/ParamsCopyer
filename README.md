# ParamsCopyer

## 简介

**ParamsCopyer** 是一个专为 Modbus TCP 设备设计的小巧高效参数同步工具。它支持批量读取和写入保持寄存器，方便现场工程师对 BMS/电池管理系统/BMU 等设备进行参数备份、导入、升级和自动化配置。  
程序内置参数比对算法，只写入有变化的寄存器，极大提升速率与稳定性，避免设备断连。  
所有操作均可视化进度，异常自动记录日志，极度安全可靠。

---

## 主要功能

- 🚀 **批量读取设备寄存器**  
  选定起始地址和数量，一键导出所有参数为 XML 配置文件。

- 📝 **智能写入参数到设备**  
  只写入与目标设备当前值不同的参数，避免重复写入、加快速度。

- 💡 **参数文件管理**  
  支持 XML 文件格式，便于参数备份、批量下发和跨设备迁移。

- 👀 **进度条显示 & 错误日志**  
  所有操作实时进度反馈，异常自动落地日志，方便追溯和排查。

- 🛡 **极度安全健壮**  
  自动检测地址合法性、批量操作边界、网络连接状态，确保设备安全。

---

## 使用方法

### 1. 读取设备参数

1. 在主界面输入目标设备 IP（如 `192.168.1.100`）。
2. 选择读取参数的起始地址和数量（如默认 100、共 300 个寄存器）。
3. 点击【读取】按钮，参数批量读取导出为 XML。
4. 保存生成的配置文件，用于备份或后续写入。

### 2. 写入参数到设备

1. 在主界面输入目标设备 IP。
2. 点击【写入】按钮，选择之前导出的 XML 配置文件。
3. 程序自动读取目标设备当前参数，仅写入有变化的数据。
4. 写入完成后弹窗提示，进度条实时显示。

---

## XML 配置文件格式示例

```xml
<Registers>
  <Register address="100" value="1234" />
  <Register address="101" value="2333" />
  ...
</Registers>
```

---

## 环境要求

- Windows 10/11
- .NET 6.0 及以上运行环境
- 目标设备需支持 Modbus TCP 协议

---

## 特色亮点

- 小巧实用，免安装，绿色软件
- 支持多型号 Modbus 设备
- 专为工程现场和自动化测试优化
- 源码可扩展，支持二次开发

---

## 问题反馈

如发现 Bug 或有定制需求，欢迎在 [Issues](https://github.com/wangchaoHZ/STD_BMS_MB_FW/issues) 提交反馈，或邮件联系开发者。

---

## License

MIT License
